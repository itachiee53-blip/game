<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Police Exam Master: ‡∏ï‡∏¥‡∏ß‡∏™‡∏≠‡∏ö‡∏ô‡∏≤‡∏¢‡∏™‡∏¥‡∏ö‡∏ï‡∏≥‡∏£‡∏ß‡∏à (Ultimate Plus)</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #2c3e50;
            --primary-light: #34495e;
            --accent: #e67e22;
            --highlight: #3498db;
            --correct: #27ae60;
            --wrong: #c0392b;
            --bg: #e9ecef;
            --card-bg: #ffffff;
            --purple: #9b59b6;
            --game-mode: #e84393;
            --cheat-mode: #f1c40f;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #333;
        }

        .app-container {
            background-color: var(--card-bg);
            width: 100%;
            max-width: 600px;
            height: auto;
            min-height: 500px;
            max-height: 98vh;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .header {
            background: var(--primary-dark);
            color: white;
            padding: 12px;
            text-align: center;
            flex-shrink: 0;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .header h1 { margin: 0; font-size: 18px; font-weight: 700; }

        .content-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 15px;
            scrollbar-width: thin;
        }

        .screen { display: none; animation: fadeIn 0.2s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Buttons */
        .btn { border: none; padding: 12px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.1s; font-family: 'Sarabun', sans-serif; display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; margin-bottom: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .btn:active { transform: scale(0.98); }
        .btn-start { background-color: var(--correct); color: white; font-size: 18px; padding: 15px; }
        .btn-vocab-game { background-color: var(--game-mode); color: white; font-size: 18px; padding: 15px; }
        .btn-analysis { background-color: var(--purple); color: white; }
        .btn-back { background-color: #95a5a6; color: white; margin-top: 10px; }
        .btn-rec { background-color: var(--wrong); color: white; padding: 12px; animation: pulse 2s infinite; }
        
        .nav-buttons { display: flex; gap: 10px; margin-top: 15px; }
        .btn-prev { background-color: #bdc3c7; color: #333; flex: 1; display: none; }
        .btn-next { background-color: var(--primary-dark); color: white; flex: 2; display: none; animation: bounce 1s infinite; }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-3px); } }

        /* Menu Grid */
        .grid-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .menu-card { background: white; border: 1px solid #eee; border-radius: 10px; padding: 12px; text-align: center; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .menu-card:hover { border-color: var(--highlight); transform: translateY(-2px); background-color: #f8f9fa; }
        .menu-card .icon { font-size: 24px; display: block; margin-bottom: 4px; }
        .menu-card .title { font-weight: bold; font-size: 13px; color: var(--primary-dark); }

        /* Vocab Table */
        .vocab-table { width: 100%; border-collapse: collapse; font-size: 14px; margin-bottom: 10px; }
        .vocab-table tr { border-bottom: 1px solid #eee; }
        .vocab-table td { padding: 8px 4px; vertical-align: middle; }
        .vocab-word { font-weight: bold; color: var(--highlight); font-size: 15px; }
        .vocab-read { font-size: 12px; color: #666; font-style: italic; display: block; margin-top: 1px; }
        .vocab-mean { text-align: right; font-weight: 500; }

        /* Cheat Sheet Table */
        .cheat-table { width: 100%; border-collapse: collapse; font-size: 14px; margin-bottom: 15px; background: #fff; border:1px solid #ddd; }
        .cheat-table th { background: var(--primary-light); color: white; padding: 10px; text-align: left; }
        .cheat-table td { border-bottom: 1px solid #eee; padding: 10px; vertical-align: top; }
        .cheat-v2 { color: var(--wrong); font-weight: bold; font-size: 16px; }
        .cheat-kw { color: var(--accent); font-weight: bold; display: block; margin-top: 4px; font-size: 12px; }

        /* Quiz UI */
        .progress-bar { height: 6px; background: #e0e0e0; border-radius: 3px; overflow: hidden; margin-bottom: 10px; }
        .progress-fill { height: 100%; background: var(--correct); width: 0%; transition: width 0.3s; }
        .quiz-header { display: flex; justify-content: space-between; font-size: 12px; color: #7f8c8d; margin-bottom: 5px; }
        .question-box { font-size: 20px; font-weight: 700; color: var(--primary-dark); margin-bottom: 15px; line-height: 1.4; background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center; }
        
        .option-btn { background: white; border: 1px solid #ccc; padding: 12px 15px; border-radius: 8px; text-align: left; font-size: 16px; color: #444; cursor: pointer; transition: 0.1s; margin-bottom: 6px; position: relative; }
        .option-btn:hover { background-color: #f0f4f8; border-color: var(--highlight); }
        .option-btn.correct { background-color: #d4edda; border-color: var(--correct); color: #155724; pointer-events: none; }
        .option-btn.wrong { background-color: #f8d7da; border-color: var(--wrong); color: #721c24; opacity: 0.8; pointer-events: none; }
        .option-btn.disabled { pointer-events: none; opacity: 0.6; }

        .feedback { margin-top: 10px; padding: 10px; border-radius: 8px; background-color: #e8f4fd; border: 1px solid #b6e0fe; display: none; text-align: center; font-size: 14px; }
        .feedback.show { display: block; }
        
        .memory-box { background-color: #fff8e1; border-left: 4px solid #ffc107; padding: 10px; margin: 8px 0; border-radius: 4px; font-size: 14px; }
    </style>
</head>
<body>

<audio id="clickSound" src="click.mp3"></audio>

<div class="app-container">
    <div class="header">
        <h1>üëÆ Police Exam Master: Ultimate Plus</h1>
        <p>‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î! 200+ ‡∏®‡∏±‡∏û‡∏ó‡πå | 60+ ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á</p>
    </div>

    <div class="content-area">

        <div class="screen active" id="mainMenu">
            <div style="text-align: center; margin: 15px 0;">
                <div style="font-size: 40px;">üöî</div>
                <h2 style="color: var(--primary-dark); margin: 5px 0;">‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏™‡∏ï.17üî•</h2>
            </div>
            
            <button class="btn btn-start" onclick="playClick(); startRandomQuiz()">
                <span>üìù ‡∏™‡∏≠‡∏ö‡∏£‡∏ß‡∏° (Mixed 20 ‡∏Ç‡πâ‡∏≠)</span>
            </button>
            
            <button class="btn btn-vocab-game" onclick="playClick(); startVocabGame()">
                <span>üéÆ ‡πÄ‡∏Å‡∏°‡∏ó‡∏≤‡∏¢‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡πà‡∏≤‡∏ô)</span>
            </button>
            
            <div class="grid-menu" style="margin-top: 15px;">
                <div class="menu-card" onclick="playClick(); showScreen('learningMenu')">
                    <span class="icon">üìö</span>
                    <span class="title">‡∏Ñ‡∏•‡∏±‡∏á‡∏®‡∏±‡∏û‡∏ó‡πå & ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</span>
                </div>
                <div class="menu-card" onclick="playClick(); analyzeWeakness()">
                    <span class="icon">üìä</span>
                    <span class="title">‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ</span>
                </div>
            </div>

            <div style="text-align: center; margin-top: 15px;">
                <small onclick="clearData()" style="color:#aaa; cursor:pointer; text-decoration:underline;">‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</small>
            </div>
        </div>

        <div class="screen" id="learningMenu">
            <h3 style="margin-top:0;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ï‡∏¥‡∏ß</h3>
            <button class="btn" style="background-color: var(--cheat-mode); color:#333; margin-bottom:15px;" onclick="playClick(); showLesson('lesson-cheat')">
                üî• <strong>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏π‡∏ï‡∏£‡∏•‡∏±‡∏ö V.1 ‚ûú V.2</strong>
            </button>

            <div class="grid-menu">
                <div class="menu-card" onclick="playClick(); showLesson('lesson-vocab')">
                    <span class="icon">üó£Ô∏è</span>
                    <span class="title">‡∏®‡∏±‡∏û‡∏ó‡πå 160 ‡∏Ñ‡∏≥ (‡∏≠‡πà‡∏≤‡∏ô+‡πÅ‡∏õ‡∏•)</span>
                </div>
                <div class="menu-card" onclick="playClick(); showLesson('lesson-grammar')">
                    <span class="icon">‚è≥</span>
                    <span class="title">Grammar ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡πà‡∏≠</span>
                </div>
                <div class="menu-card" onclick="playClick(); showLesson('lesson-convo')">
                    <span class="icon">üí¨</span>
                    <span class="title">Conversation</span>
                </div>
                <div class="menu-card" onclick="playClick(); showLesson('lesson-tricks')">
                    <span class="icon">‚ö°</span>
                    <span class="title">‡∏™‡∏π‡∏ï‡∏£‡∏•‡∏±‡∏î‡∏ï‡∏±‡∏î‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå</span>
                </div>
            </div>
            <button class="btn btn-back" onclick="playClick(); showScreen('mainMenu')">‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
        </div>

        <div class="screen" id="lessonContent">
            
            <div id="lesson-cheat" class="lesson-detail" style="display:none;">
                <h3 style="border-bottom:2px solid var(--accent); padding-bottom:5px;">üî• ‡∏™‡∏π‡∏ï‡∏£‡∏•‡∏±‡∏î: ‡∏Ñ‡∏≥‡∏Ñ‡∏π‡πà & ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î</h3>
                
                <p><strong>1. ‡∏Å‡∏≤‡∏£‡∏ú‡∏±‡∏ô‡∏Å‡∏£‡∏¥‡∏¢‡∏≤ (Present ‚ûú Past)</strong><br>
                <small>‡πÄ‡∏à‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <em>Yesterday, Last..., Ago, In 1999</em> ‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏ä‡πà‡∏≠‡∏á 2 ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!</small></p>
                
                <table class="cheat-table">
                    <thead>
                        <tr>
                            <th>‡∏ä‡πà‡∏≠‡∏á 1 (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</th>
                            <th>‡∏ä‡πà‡∏≠‡∏á 2 (‡∏≠‡∏î‡∏µ‡∏ï)</th>
                            <th>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ / ‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>is, am <br>(‡πÄ‡∏õ‡πá‡∏ô/‡∏≠‡∏¢‡∏π‡πà/‡∏Ñ‡∏∑‡∏≠)</td>
                            <td><span class="cheat-v2">was</span></td>
                            <td>‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô 1 ‡∏Ñ‡∏ô (He, She, It, I)<br><span class="cheat-kw">KW: Yesterday, Last night</span></td>
                        </tr>
                        <tr>
                            <td>are <br>(‡πÄ‡∏õ‡πá‡∏ô/‡∏≠‡∏¢‡∏π‡πà/‡∏Ñ‡∏∑‡∏≠)</td>
                            <td><span class="cheat-v2">were</span></td>
                            <td>‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô (You, We, They)<br><span class="cheat-kw">KW: Yesterday, Last year</span></td>
                        </tr>
                        <tr>
                            <td>has, have <br>(‡∏°‡∏µ/‡∏Å‡∏¥‡∏ô)</td>
                            <td><span class="cheat-v2">had</span></td>
                            <td>‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ "‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß/‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß" (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô)<br><span class="cheat-kw">KW: Before, Last...</span></td>
                        </tr>
                        <tr>
                            <td>go <br>(‡πÑ‡∏õ)</td>
                            <td><span class="cheat-v2">went</span></td>
                            <td>‡πÑ‡∏õ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏à‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß)<br><span class="cheat-kw">KW: ...ago</span></td>
                        </tr>
                        <tr>
                            <td>do, does <br>(‡∏ó‡∏≥)</td>
                            <td><span class="cheat-v2">did</span></td>
                            <td>‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß<br><span class="cheat-kw">KW: Yesterday</span></td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>2. ‡∏Ñ‡∏≥‡∏ö‡∏∏‡∏û‡∏ö‡∏ó (Prepositions) ‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≥!</strong></p>
                <table class="cheat-table">
                    <thead>
                        <tr>
                            <th>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</th>
                            <th>‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤</th>
                            <th>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≠... (‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î‡πÉ‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="cheat-v2">At</span></td>
                            <td>‡∏ó‡∏µ‡πà / ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πä‡∏∞‡πÜ</td>
                            <td>
                                ‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤: 6:00 PM, Noon, Night<br>
                                üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: At school, At the station
                            </td>
                        </tr>
                        <tr>
                            <td><span class="cheat-v2">On</span></td>
                            <td>‡∏ö‡∏ô / ‡∏ß‡∏±‡∏ô</td>
                            <td>
                                üìÖ ‡∏ß‡∏±‡∏ô: Monday, Birthday, Christmas Day<br>
                                üì¶ ‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß: On the table, On the road
                            </td>
                        </tr>
                        <tr>
                            <td><span class="cheat-v2">In</span></td>
                            <td>‡πÉ‡∏ô</td>
                            <td>
                                üóìÔ∏è ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ: In July, In 1999<br>
                                üèôÔ∏è ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà: In Bangkok, In Thailand
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="lesson-vocab" class="lesson-detail" style="display:none;">
                <h3 style="border-bottom:2px solid var(--accent); padding-bottom:5px;">üõë ‡∏Ñ‡∏•‡∏±‡∏á‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡∏≥‡∏£‡∏ß‡∏à (160+ ‡∏Ñ‡∏≥)</h3>
                <input type="text" id="vocabSearch" placeholder="üîç ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå..." style="width:90%; padding:8px; margin-bottom:10px; border:1px solid #ddd; border-radius:5px;" onkeyup="filterVocab()">
                <table class="vocab-table">
                    <tbody id="vocabTableBody"></tbody>
                </table>
            </div>

            <div id="lesson-grammar" class="lesson-detail" style="display:none;">
                <h3>‚è≥ Grammar ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡πà‡∏≠ (2 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏≠‡∏ö)</h3>
                <div class="memory-box">
                    <strong>1. 12 Tenses (‡∏à‡∏≥‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ‡∏û‡∏≠):</strong><br>
                    - <strong>Present Sim:</strong> ‡∏à‡∏£‡∏¥‡∏á/‡∏ô‡∏¥‡∏™‡∏±‡∏¢ (always, usually) ‚Üí V.1 (s/es)<br>
                    - <strong>Present Cont:</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥ (now) ‚Üí is/am/are + ing<br>
                    - <strong>Past Sim:</strong> ‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß (ago, yesterday) ‚Üí V.2<br>
                    - <strong>Future:</strong> ‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï (tomorrow) ‚Üí will + V.1
                </div>
                <div class="memory-box">
                    <strong>2. If-Clause (‡∏≠‡∏≠‡∏Å‡∏ä‡∏±‡∏ß‡∏£‡πå):</strong><br>
                    - <strong>Type 1 (‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ):</strong> If V.1, ... will V.1<br>
                    - <strong>Type 2 (‡∏°‡πÇ‡∏ô):</strong> If V.2, ... would V.1<br>
                    *‡∏à‡∏≥: If I <u>were</u> a bird (‡πÉ‡∏ä‡πâ were ‡πÄ‡∏™‡∏°‡∏≠)
                </div>
                 <div class="memory-box">
                    <strong>3. Subject-Verb Agreement:</strong><br>
                    - ‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (He/She/It) ‚Üí ‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏ï‡∏¥‡∏° <strong>s</strong><br>
                    - ‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô (They/We/Police) ‚Üí ‡∏Å‡∏£‡∏¥‡∏¢‡∏≤ <strong>‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏¥‡∏° s</strong><br>
                    - <em>Everybody / Everyone</em> ‡∏ô‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏Ñ‡∏ô (‡πÄ‡∏≠‡∏Å‡∏û‡∏à‡∏ô‡πå)
                </div>
            </div>

            <div id="lesson-tricks" class="lesson-detail" style="display:none;">
                <h3>‚ö° ‡∏™‡∏π‡∏ï‡∏£‡∏•‡∏±‡∏î‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥</h3>
                <div class="memory-box">
                    <strong>üõë Stop V.ing vs Stop to V.1</strong><br>
                    - Stop smok<strong>ing</strong> (‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏π‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£)<br>
                    - Stop <strong>to</strong> smoke (‡∏´‡∏¢‡∏∏‡∏î‡∏á‡∏≤‡∏ô...‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏õ‡∏™‡∏π‡∏ö)
                </div>
                <div class="memory-box">
                    <strong>üëÆ Passive Voice (‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏≥)</strong><br>
                    - ‡πÄ‡∏´‡πá‡∏ô by... ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á ‚Üí <strong>V.to be + V.3</strong><br>
                    - The car <u>was stolen</u>.
                </div>
                <div class="memory-box">
                    <strong>‡∏Ñ‡∏≥‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° (Conjunctions):</strong><br>
                    - <strong>Because</strong> + ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ (‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô+‡∏Å‡∏£‡∏¥‡∏¢‡∏≤)<br>
                    - <strong>Because of</strong> + ‡∏Ñ‡∏≥‡∏ô‡∏≤‡∏° (Because of the rain)<br>
                    - <strong>Although</strong> = ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤ (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á)
                </div>
            </div>

            <div id="lesson-convo" class="lesson-detail" style="display:none;">
                <h3>üí¨ Conversation</h3>
                <div class="memory-box">
                    <strong>‚ùì Mind (‡∏£‡∏±‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡πÑ‡∏´‡∏°?)</strong><br>
                    - Do you mind...?<br>
                    - ‡∏ñ‡πâ‡∏≤ "‡πÇ‡∏≠‡πÄ‡∏Ñ/‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏•‡∏¢" ‡∏ï‡∏≠‡∏ö <strong>No, not at all</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>Go ahead</strong>
                </div>
            </div>

            <button class="btn btn-back" onclick="playClick(); showScreen('learningMenu')">‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</button>
        </div>

        <div class="screen" id="analysisScreen">
            <h3 style="text-align:center;">üìä ‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (Sprint)</h3>
            <div id="recommendationArea" class="recommend-box" style="background:#fff0f0; padding:15px; border-radius:10px; text-align:center; display:none; border:2px dashed var(--wrong);">
                <h3>‚ö†Ô∏è ‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏î‡πà‡∏ß‡∏ô!</h3>
                <p>‡∏Ñ‡∏∏‡∏ì‡∏ú‡∏¥‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á <strong id="weakPointName">...</strong> ‡∏ö‡πà‡∏≠‡∏¢‡∏™‡∏∏‡∏î</p>
                <button id="goToLessonBtn" class="btn btn-rec">üöÄ ‡πÑ‡∏õ‡∏ï‡∏¥‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ</button>
            </div>
            <div id="statContainer" style="margin-top:15px; background:white; padding:10px; border-radius:10px;"></div>
            <button class="btn btn-back" onclick="playClick(); showScreen('mainMenu')">‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
        </div>

        <div class="screen" id="quizScreen">
            <div class="quiz-header">
                <span id="qCategoryTag">‡∏´‡∏°‡∏ß‡∏î: Grammar</span>
                <span id="qCounter">1/20</span>
            </div>
            <div class="progress-bar"><div id="progressFill" class="progress-fill"></div></div>
            
            <div id="questionText" class="question-box">Loading...</div>
            <div id="subQuestionText" style="text-align:center; color:#666; font-size:14px; margin-bottom:10px; display:none;">‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?</div>
            
            <div id="optionsList"></div>
            <div id="feedback" class="feedback"></div>
            
            <div class="nav-buttons">
                <button id="prevBtn" class="btn btn-prev" onclick="playClick(); prevQuestion()">‚¨ÖÔ∏è ‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                <button id="nextBtn" class="btn btn-next" onclick="playClick(); nextQuestion()">‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûú</button>
            </div>
        </div>

        <div class="screen" id="resultScreen">
            <div style="text-align: center; padding-top: 30px;">
                <div style="width: 100px; height: 100px; background: var(--primary-dark); color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 32px; font-weight: bold; margin: 0 auto 20px;">
                    <span id="finalScore">0/0</span>
                </div>
                <h2 id="resultTitle">‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!</h2>
                
                <button class="btn btn-analysis" onclick="playClick(); analyzeWeakness()">üìä ‡∏î‡∏π‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô</button>
                <button class="btn btn-start" onclick="playClick(); startRandomQuiz()">üìù ‡∏™‡∏≠‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏´‡∏°‡πà</button>
                <button class="btn btn-vocab-game" onclick="playClick(); startVocabGame()">üéÆ ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏®‡∏±‡∏û‡∏ó‡πå</button>
                <button class="btn btn-back" onclick="playClick(); showScreen('mainMenu')">‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
            </div>
        </div>

    </div>
</div>

<script>
    function playClick() {
        const audio = document.getElementById("clickSound");
        audio.currentTime = 0;
        audio.play().catch(e => {});
    }

    // --- 1. Question Bank (Expanded to 60+ Questions) ---
    const questionBank = [
        // --- Tenses & Verb Forms ---
        { q: "If it rains tomorrow, I ______ at home.", options: ["stay", "will stay", "stayed", "would stay"], answer: 1, note: "If-Clause Type 1: If + V.1, will + V.1", cat: "grammar" },
        { q: "If I ______ a bird, I would fly.", options: ["was", "am", "were", "been"], answer: 2, note: "If-Clause Type 2: ‡∏™‡∏°‡∏°‡∏ï‡∏¥ ‡πÉ‡∏ä‡πâ were ‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô", cat: "grammar" },
        { q: "If he had driven carefully, he ______ an accident.", options: ["would have", "will not have", "wouldn't have had", "has not"], answer: 2, note: "If-Clause Type 3: If + had V.3, ... would have V.3", cat: "grammar" },
        { q: "The thief ______ by the police yesterday.", options: ["arrests", "was arrested", "is arrested", "arrested"], answer: 1, note: "Passive Voice + Past (yesterday): was + V.3", cat: "grammar" },
        { q: "Look! The bus ______.", options: ["come", "comes", "is coming", "came"], answer: 2, note: "Look! = ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏¥‡∏î (is coming)", cat: "grammar" },
        { q: "He ______ to the station an hour ago.", options: ["go", "goes", "went", "gone"], answer: 2, note: "Ago = ‡∏≠‡∏î‡∏µ‡∏ï (V.2 went)", cat: "grammar" },
        { q: "She has lived here ______ 2010.", options: ["since", "for", "ago", "during"], answer: 0, note: "Since + ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏õ‡∏µ...)", cat: "grammar" },
        { q: "I have lived here ______ 10 years.", options: ["since", "for", "ago", "in"], answer: 1, note: "For + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤", cat: "grammar" },
        { q: "While I ______ TV, the phone rang.", options: ["watch", "watched", "was watching", "is watching"], answer: 2, note: "Past Cont (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥) ‡πÅ‡∏ó‡∏£‡∏Å‡∏î‡πâ‡∏ß‡∏¢ Past Sim", cat: "grammar" },
        { q: "She usually ______ to school by bus.", options: ["go", "goes", "going", "went"], answer: 1, note: "Usually = ‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ï‡∏£ (Present Sim) ‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô She ‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏ï‡∏¥‡∏° es", cat: "grammar" },
        { q: "They ______ football right now.", options: ["play", "plays", "are playing", "played"], answer: 2, note: "Right now = ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥", cat: "grammar" },
        { q: "Yesterday, I ______ a loud noise.", options: ["hear", "hears", "heard", "hearing"], answer: 2, note: "Yesterday = ‡∏≠‡∏î‡∏µ‡∏ï (V.2 heard)", cat: "grammar" },
        { q: "By the time the police arrived, the thief ______.", options: ["escapes", "escaped", "has escaped", "had escaped"], answer: 3, note: "Past Perfect: ‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä ‡πâhad V.3, ‡πÄ‡∏Å‡∏¥‡∏î‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ V.2", cat: "grammar" },
        { q: "I ______ to Thailand next month.", options: ["travel", "travelled", "am travelling", "have travelled"], answer: 2, note: "V.ing ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ", cat: "grammar" },

        // --- Subject-Verb Agreement & Prepositions ---
        { q: "Everyone ______ to be happy.", options: ["want", "wants", "wanting", "wanted"], answer: 1, note: "Everyone ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏Å‡∏û‡∏à‡∏ô‡πå ‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏ï‡∏¥‡∏° s", cat: "grammar" },
        { q: "One of the boys ______ sick.", options: ["is", "are", "were", "have"], answer: 0, note: "One of... (‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô) ‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏≠ One ‡πÉ‡∏ä‡πâ is", cat: "grammar" },
        { q: "Neither the teacher nor the students ______ here.", options: ["is", "are", "was", "has"], answer: 1, note: "Neither...nor ‡∏ú‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏•‡∏±‡∏á (students = are)", cat: "grammar" },
        { q: "A lot of money ______ stolen.", options: ["was", "were", "are", "have"], answer: 0, note: "Money ‡∏ô‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏Å‡∏û‡∏à‡∏ô‡πå (was)", cat: "grammar" },
        { q: "He is good ______ English.", options: ["in", "on", "at", "by"], answer: 2, note: "Good at = ‡πÄ‡∏Å‡πà‡∏á‡πÉ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á...", cat: "grammar" },
        { q: "I was born ______ July.", options: ["in", "on", "at", "of"], answer: 0, note: "In + ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ", cat: "grammar" },
        { q: "See you ______ Monday.", options: ["in", "on", "at", "by"], answer: 1, note: "On + ‡∏ß‡∏±‡∏ô", cat: "grammar" },
        { q: "The meeting starts ______ 9:00 AM.", options: ["in", "on", "at", "during"], answer: 2, note: "At + ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πä‡∏∞‡πÜ", cat: "grammar" },
        { q: "There isn't ______ water left.", options: ["many", "some", "much", "few"], answer: 2, note: "Water ‡∏ô‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ + ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò ‡πÉ‡∏ä‡πâ Much", cat: "grammar" },
        { q: "Do you have ______ money?", options: ["some", "any", "many", "few"], answer: 1, note: "‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ä‡πâ Any", cat: "grammar" },
        { q: "______ car is this?", options: ["Who", "Whose", "Whom", "Who's"], answer: 1, note: "Whose = ‡∏Ç‡∏≠‡∏á‡πÉ‡∏Ñ‡∏£", cat: "grammar" },
        { q: "The book is ______ the table.", options: ["in", "on", "at", "to"], answer: 1, note: "On the table = ‡∏ö‡∏ô‡πÇ‡∏ï‡πä‡∏∞", cat: "grammar" },
        { q: "The police station is ______ the bank.", options: ["next", "near to", "next to", "between"], answer: 2, note: "Next to = ‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ö/‡∏ñ‡∏±‡∏î‡∏à‡∏≤‡∏Å", cat: "grammar" },
        { q: "The man ______ stole the car was arrested.", options: ["who", "whom", "whose", "which"], answer: 0, note: "Who ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ô (‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏¢‡πà‡∏≠‡∏¢)", cat: "grammar" },
        
        // --- Conjunctions & Connectors ---
        { q: "He didn't go to work ______ he was sick.", options: ["because", "because of", "although", "but"], answer: 0, note: "Because + ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ (he was sick)", cat: "grammar" },
        { q: "______ the rain, we stayed home.", options: ["Because", "Because of", "Although", "However"], answer: 1, note: "Because of + ‡∏Ñ‡∏≥‡∏ô‡∏≤‡∏° (the rain)", cat: "grammar" },
        { q: "______ it was raining, he went out.", options: ["Because", "Due to", "Although", "Despite"], answer: 2, note: "Although = ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤ (‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á)", cat: "grammar" },
        { q: "He studied hard, ______ he failed the exam.", options: ["so", "but", "and", "or"], answer: 1, note: "But ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á", cat: "grammar" },
        
        // --- Vocab & Tricks ---
        { q: "We avoided ______ him.", options: ["meet", "to meet", "meeting", "met"], answer: 2, note: "Avoid + V.ing", cat: "tricks" },
        { q: "She enjoys ______ books.", options: ["read", "reading", "to read", "reads"], answer: 1, note: "Enjoy + V.ing", cat: "tricks" },
        { q: "You ______ stop when the light is red.", options: ["can", "may", "must", "should"], answer: 2, note: "Must = ‡∏ï‡πâ‡∏≠‡∏á (‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)", cat: "grammar" },
        { q: "You ______ smoke in the hospital.", options: ["must", "mustn't", "don't have to", "should"], answer: 1, note: "Mustn't = ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î", cat: "grammar" },
        { q: "I stop ______ cigarette.", options: ["smoking", "to smoke", "smokes", "smoke"], answer: 0, note: "Stop + ing = ‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ñ‡∏≤‡∏ß‡∏£", cat: "tricks" },
        { q: "He made me ______.", options: ["to cry", "crying", "cry", "cried"], answer: 2, note: "Make someone + V.pure (‡πÑ‡∏°‡πà‡∏°‡∏µ to)", cat: "tricks" },
        { q: "Would you mind ______ the window?", options: ["open", "to open", "opening", "opened"], answer: 2, note: "Would you mind + V.ing", cat: "tricks" },
        
        // --- Reading Signs & Notices ---
        { q: "Sign: <b>NO ENTRY</b>", options: ["You can enter.", "Do not enter.", "Park here.", "Exit only."], answer: 1, note: "No Entry = ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤", cat: "grammar" },
        { q: "Sign: <b>OUT OF ORDER</b>", options: ["Working.", "Broken.", "Open.", "New."], answer: 1, note: "Out of order = ‡πÄ‡∏™‡∏µ‡∏¢/‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ", cat: "grammar" },
        { q: "Sign: <b>NO PARKING</b>", options: ["Park here.", "Do not park.", "Free parking.", "Parking lot."], answer: 1, note: "No Parking = ‡∏´‡πâ‡∏≤‡∏°‡∏à‡∏≠‡∏î", cat: "grammar" },
        { q: "Notice: <b>WET PAINT</b>", options: ["Touch it.", "Do not touch.", "Paint it.", "Dry paint."], answer: 1, note: "Wet Paint = ‡∏™‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏ó‡∏≤ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏´‡πâ‡∏á)", cat: "grammar" },
        { q: "Sign: <b>BEWARE OF DOG</b>", options: ["Feed the dog.", "The dog is dangerous.", "Buy a dog.", "Play with the dog."], answer: 1, note: "Beware = ‡∏£‡∏∞‡∏ß‡∏±‡∏á", cat: "grammar" },
        { q: "Sign: <b>SPEED LIMIT 80</b>", options: ["Drive faster than 80.", "Drive exactly 80.", "Do not drive over 80.", "Stop at 80."], answer: 2, note: "Speed Limit = ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß", cat: "grammar" },
        
        // --- Conversation (Police Situations) ---
        { q: "A: Thank you very much. <br> B: ______", options: ["Never mind.", "You're welcome.", "I'm sorry.", "Good luck."], answer: 1, note: "‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì = You're welcome", cat: "convo" },
        { q: "A: I'm sorry I'm late. <br> B: ______", options: ["Good idea.", "Never mind.", "Yes, please.", "Thank you."], answer: 1, note: "‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡πÇ‡∏ó‡∏© = Never mind (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£)", cat: "convo" },
        { q: "Tourist: Excuse me, where is the police station? <br> You: ______", options: ["Yes, I am.", "Go straight and turn left.", "I want to go.", "It is big."], answer: 1, note: "‡∏ö‡∏≠‡∏Å‡∏ó‡∏≤‡∏á: Go straight...", cat: "convo" },
        { q: "Officer: May I see your license? <br> Driver: ______", options: ["No, thank you.", "Here you are.", "Yes, I do.", "I am driving."], answer: 1, note: "‡∏¢‡∏∑‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏û‡∏π‡∏î Here you are", cat: "convo" },
        { q: "Do you mind if I open the window?", options: ["Yes, I do.", "No, not at all.", "Thank you.", "I am sorry."], answer: 1, note: "‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ï‡∏≠‡∏ö No, not at all (‡πÑ‡∏°‡πà‡∏£‡∏±‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡πÄ‡∏•‡∏¢)", cat: "convo" },
        { q: "Victim: Help! My bag was stolen. <br> Police: ______", options: ["You are welcome.", "Calm down, please tell me what happened.", "Go away.", "It is yours."], answer: 1, note: "‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå", cat: "convo" },
        { q: "Driver: I was driving too fast. I'm sorry. <br> Officer: ______", options: ["Good job.", "I have to give you a ticket.", "Don't worry.", "Go home."], answer: 1, note: "‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡πÄ‡∏£‡πá‡∏ß = ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á (Ticket)", cat: "convo" },
        { q: "Police: Do you know why I stopped you? <br> Driver: ______", options: ["Yes, I am fine.", "I have no idea, officer.", "Good morning.", "I am hungry."], answer: 1, note: "I have no idea = ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö", cat: "convo" },
        
        // --- More General Exam Items ---
        { q: "Which word means 'Start'?", options: ["End", "Finish", "Begin", "Stop"], answer: 2, note: "Begin = Start (‡πÄ‡∏£‡∏¥‡πà‡∏°)", cat: "vocab" },
        { q: "Which word is OPPOSITE to 'Dangerous'?", options: ["Safe", "Scary", "Risk", "Bad"], answer: 0, note: "Safe (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢) ‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏° Dangerous", cat: "vocab" },
        { q: "Which word is OPPOSITE to 'Guilty'?", options: ["Bad", "Innocent", "Wrong", "Prisoner"], answer: 1, note: "Innocent (‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå) ‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏° Guilty", cat: "vocab" },
        { q: "My car ______ down yesterday.", options: ["break", "broke", "broken", "breaking"], answer: 1, note: "Break down = ‡πÄ‡∏™‡∏µ‡∏¢ (‡∏≠‡∏î‡∏µ‡∏ï‡πÉ‡∏ä‡πâ Broke)", cat: "grammar" },
        { q: "The suspect is under ______.", options: ["arrest", "home", "school", "hospital"], answer: 0, note: "Under arrest = ‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°", cat: "vocab" },
        { q: "Please ______ your seatbelt.", options: ["take off", "fasten", "open", "close"], answer: 1, note: "Fasten seatbelt = ‡∏Ñ‡∏≤‡∏î‡πÄ‡∏Ç‡πá‡∏°‡∏Ç‡∏±‡∏î", cat: "vocab" },
        { q: "He was charged ______ murder.", options: ["of", "with", "at", "for"], answer: 1, note: "Charged with = ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ç‡πâ‡∏≠‡∏´‡∏≤...", cat: "grammar" },
        { q: "The police are ______ the case.", options: ["looking", "investigating", "inventing", "inviting"], answer: 1, note: "Investigating = ‡∏™‡∏∑‡∏ö‡∏™‡∏ß‡∏ô", cat: "vocab" },
        { q: "You must pay a ______ for parking here.", options: ["price", "fine", "cost", "bill"], answer: 1, note: "Fine = ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö", cat: "vocab" },
        { q: "The firemen put ______ the fire.", options: ["on", "out", "in", "off"], answer: 1, note: "Put out = ‡∏î‡∏±‡∏ö‡πÑ‡∏ü", cat: "tricks" },
        { q: "He ran ______ of money.", options: ["out", "in", "away", "off"], answer: 0, note: "Run out of = ‡∏´‡∏°‡∏î/‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô", cat: "tricks" }
    ];

    // --- 2. Vocab Database (Expanded to 160+ Words) ---
    const vocabData = [
        // ‡∏´‡∏°‡∏ß‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏î‡∏µ
        { en: "Arrest", read: "‡∏≠‡∏∞-‡πÄ‡∏£‡∏™‡∏ó‡πå", th: "‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°" },
        { en: "Warrant", read: "‡∏ß‡∏≠‡∏£‡πå-‡πÅ‡∏£‡∏ô‡∏ó‡πå", th: "‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏ö/‡∏Ñ‡πâ‡∏ô" },
        { en: "Suspect", read: "‡∏ã‡∏±‡∏™-‡πÄ‡∏õ‡∏Ñ‡∏ó‡πå", th: "‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏á‡∏™‡∏±‡∏¢" },
        { en: "Victim", read: "‡∏ß‡∏¥‡∏Ñ-‡∏ó‡∏¥‡∏°", th: "‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠" },
        { en: "Witness", read: "‡∏ß‡∏¥‡∏ó-‡πÄ‡∏ô‡∏™", th: "‡∏û‡∏¢‡∏≤‡∏ô" },
        { en: "Evidence", read: "‡πÄ‡∏≠‡∏ü-‡∏ß‡∏¥-‡πÄ‡∏î‡∏ô‡∏ã‡πå", th: "‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô" },
        { en: "Investigation", read: "‡∏≠‡∏¥‡∏ô-‡πÄ‡∏ß‡∏™-‡∏ó‡∏¥-‡πÄ‡∏Å-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô" },
        { en: "Interrogate", read: "‡∏≠‡∏¥‡∏ô-‡πÄ‡∏ó‡∏≠-‡πÇ‡∏£-‡πÄ‡∏Å‡∏ó", th: "‡∏™‡∏≠‡∏ö‡∏õ‡∏≤‡∏Å‡∏Ñ‡∏≥" },
        { en: "Custody", read: "‡∏Ñ‡∏±‡∏™-‡πÇ‡∏ï-‡∏î‡∏µ‡πâ", th: "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏±‡∏á" },
        { en: "Handcuffs", read: "‡πÅ‡∏Æ‡∏ô‡∏î‡πå-‡∏Ñ‡∏±‡∏ü‡∏™‡πå", th: "‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏°‡∏∑‡∏≠" },
        { en: "Court", read: "‡∏Ñ‡∏≠‡∏£‡πå‡∏ó", th: "‡∏®‡∏≤‡∏•" },
        { en: "Judge", read: "‡∏à‡∏±‡∏î‡∏à‡πå", th: "‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤" },
        { en: "Lawyer", read: "‡∏•‡∏≠-‡πÄ‡∏¢‡πà‡∏≠‡∏£‡πå", th: "‡∏ó‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°" },
        { en: "Prosecutor", read: "‡∏û‡∏£ ‡∏≠‡∏™-‡∏™‡∏¥-‡∏Ñ‡∏¥‡∏ß-‡πÄ‡∏ï‡∏≠‡∏£‡πå", th: "‡∏≠‡∏±‡∏¢‡∏Å‡∏≤‡∏£" },
        { en: "Defendant", read: "‡∏î‡∏¥-‡πÄ‡∏ü‡∏ô-‡πÅ‡∏î‡∏ô‡∏ó‡πå", th: "‡∏à‡∏≥‡πÄ‡∏•‡∏¢" },
        { en: "Plaintiff", read: "‡πÄ‡∏û‡∏•‡∏ô-‡∏ó‡∏¥‡∏ü", th: "‡πÇ‡∏à‡∏ó‡∏Å‡πå" },
        { en: "Verdict", read: "‡πÄ‡∏ß‡∏≠‡∏£‡πå-‡∏î‡∏¥‡∏Ñ‡∏ó‡πå", th: "‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô" },
        { en: "Sentence", read: "‡πÄ‡∏ã‡∏ô-‡πÄ‡∏ó‡πâ‡∏ô‡∏ã‡πå", th: "‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©" },
        { en: "Guilty", read: "‡∏Å‡∏¥‡∏•-‡∏ï‡∏µ‡πâ", th: "‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î" },
        { en: "Innocent", read: "‡∏≠‡∏¥‡∏ô-‡πÇ‡∏ô-‡πÄ‡∏ã‡∏ô‡∏ó‡πå", th: "‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå" },
        { en: "Appeal", read: "‡∏≠‡∏∞-‡∏û‡∏µ‡∏•", th: "‡∏≠‡∏∏‡∏ó‡∏ò‡∏£‡∏ì‡πå" },
        { en: "Bail", read: "‡πÄ‡∏ö‡∏•", th: "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ï‡∏±‡∏ß" },
        { en: "Fine", read: "‡πÑ‡∏ü‡∏ô‡πå", th: "‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö" },
        { en: "Jail", read: "‡πÄ‡∏à‡∏•", th: "‡∏Ñ‡∏∏‡∏Å (‡πÄ‡∏•‡πá‡∏Å)" },
        { en: "Prison", read: "‡∏û‡∏£‡∏¥-‡∏ã‡∏±‡πà‡∏ô", th: "‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏à‡∏≥ (‡πÉ‡∏´‡∏ç‡πà)" },
        { en: "Law", read: "‡∏•‡∏≠‡∏ß‡πå", th: "‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢" },
        { en: "Justice", read: "‡∏à‡∏±‡∏™-‡∏ó‡∏¥‡∏ã", th: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°" },
        { en: "Rights", read: "‡πÑ‡∏£‡∏ó‡∏™‡πå", th: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥" },
        { en: "Confess", read: "‡∏Ñ‡∏≠‡∏ô-‡πÄ‡∏ü‡∏™", th: "‡∏™‡∏≤‡∏£‡∏†‡∏≤‡∏û" },
        { en: "Deny", read: "‡∏î‡∏¥-‡∏ô‡∏≤‡∏¢", th: "‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò" },
        { en: "Testify", read: "‡πÄ‡∏ó‡∏™-‡∏ó‡∏¥-‡∏ü‡∏≤‡∏¢", th: "‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¢‡∏≤‡∏ô" },
        { en: "Oath", read: "‡πÇ‡∏≠‡∏ò", th: "‡∏Ñ‡∏≥‡∏™‡∏≤‡∏ö‡∏≤‡∏ô" },
        { en: "Penalty", read: "‡πÄ‡∏û‡∏ô-‡∏ô‡∏±‡∏•-‡∏ï‡∏µ‡πâ", th: "‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÇ‡∏ó‡∏©" },
        { en: "Probation", read: "‡πÇ‡∏õ‡∏£-‡πÄ‡∏ö-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏û‡∏§‡∏ï‡∏¥" },
        { en: "Parole", read: "‡∏û‡∏∞-‡πÇ‡∏£‡∏•", th: "‡∏ó‡∏±‡∏ì‡∏ë‡πå‡∏ö‡∏ô" },
        { en: "Extradition", read: "‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå-‡∏ï‡∏£‡∏≤-‡∏î‡∏¥-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏£‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏î‡∏ô" },
        { en: "Allegation", read: "‡∏≠‡∏±‡∏•-‡πÄ‡∏•-‡πÄ‡∏Å-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏Ç‡πâ‡∏≠‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤" },
        { en: "Accomplice", read: "‡∏≠‡∏∞-‡∏Ñ‡∏≠‡∏°-‡∏û‡∏•‡∏¥‡∏ã", th: "‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏£‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Ñ‡∏¥‡∏î" },
        { en: "Alibi", read: "‡πÅ‡∏≠-‡∏•‡∏¥-‡∏ö‡∏≤‡∏¢", th: "‡∏ñ‡∏¥‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà(‡∏Ç‡πâ‡∏≠‡∏≠‡πâ‡∏≤‡∏á)" },

        // ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°
        { en: "Crime", read: "‡πÑ‡∏Ñ‡∏£‡∏°‡πå", th: "‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°" },
        { en: "Theft", read: "‡πÄ‡∏ò‡∏ü‡∏ó‡πå", th: "‡∏Å‡∏≤‡∏£‡∏Ç‡πÇ‡∏°‡∏¢" },
        { en: "Robbery", read: "‡∏£‡πá‡∏≠‡∏ö-‡πÄ‡∏ö‡∏≠-‡∏£‡∏µ‡πà", th: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πâ‡∏ô" },
        { en: "Burglary", read: "‡πÄ‡∏ö‡∏≠‡∏£‡πå-‡∏Å‡∏•‡∏≤-‡∏£‡∏µ‡πà", th: "‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ö‡∏≤/‡∏á‡∏±‡∏î‡πÅ‡∏á‡∏∞" },
        { en: "Murder", read: "‡πÄ‡∏°‡∏≠-‡πÄ‡∏î‡∏≠‡∏£‡πå", th: "‡∏Ü‡∏≤‡∏ï‡∏Å‡∏£‡∏£‡∏°" },
        { en: "Assault", read: "‡∏≠‡∏∞-‡∏ã‡∏≠‡∏•‡∏ó‡πå", th: "‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢" },
        { en: "Fraud", read: "‡∏ü‡∏£‡∏≠‡∏î", th: "‡∏â‡πâ‡∏≠‡πÇ‡∏Å‡∏á" },
        { en: "Bribe", read: "‡πÑ‡∏ö‡∏£‡∏ö‡πå", th: "‡∏™‡∏¥‡∏ô‡∏ö‡∏ô" },
        { en: "Corruption", read: "‡∏Ñ‡∏≠-‡∏£‡∏±‡∏õ-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï" },
        { en: "Kidnap", read: "‡∏Ñ‡∏¥‡∏î-‡πÅ‡∏ô‡∏õ", th: "‡∏•‡∏±‡∏Å‡∏û‡∏≤‡∏ï‡∏±‡∏ß" },
        { en: "Hostage", read: "‡∏Æ‡∏≠‡∏™-‡πÄ‡∏ó‡∏à", th: "‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô" },
        { en: "Arson", read: "‡∏≠‡∏≤‡∏£‡πå-‡∏ã‡∏±‡πà‡∏ô", th: "‡∏•‡∏≠‡∏ö‡∏ß‡∏≤‡∏á‡πÄ‡∏û‡∏•‡∏¥‡∏á" },
        { en: "Smuggle", read: "‡∏™‡∏°‡∏±‡∏Å-‡πÄ‡∏Å‡∏¥‡πâ‡∏•", th: "‡∏•‡∏±‡∏Å‡∏•‡∏≠‡∏ö‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤" },
        { en: "Drug", read: "‡∏î‡∏£‡∏±‡∏Å", th: "‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î" },
        { en: "Narcotics", read: "‡∏ô‡∏≤‡∏£‡πå-‡∏Ñ‡∏≠-‡∏ï‡∏¥‡∏Å‡∏™‡πå", th: "‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î(‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£)" },
        { en: "Trafficking", read: "‡πÅ‡∏ó‡∏£‡∏ü-‡∏ü‡∏¥‡∏Å-‡∏Å‡∏¥‡πâ‡∏á", th: "‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå/‡∏¢‡∏≤" },
        { en: "Homicide", read: "‡∏Æ‡∏≠-‡∏°‡∏¥-‡πÑ‡∏ã‡∏î‡πå", th: "‡∏Ü‡∏≤‡∏ï‡∏Å‡∏£‡∏£‡∏°" },
        { en: "Blackmail", read: "‡πÅ‡∏ö‡∏•‡πá‡∏Ñ-‡πÄ‡∏°‡∏•", th: "‡∏Ç‡∏π‡πà‡∏Å‡∏£‡∏£‡πÇ‡∏ä‡∏Å" },
        { en: "Vandalism", read: "‡πÅ‡∏ß‡∏ô-‡∏î‡∏≤-‡∏•‡∏¥-‡∏ã‡∏∂‡πà‡∏°", th: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô" },
        { en: "Domestic Violence", read: "‡πÇ‡∏î-‡πÄ‡∏°‡∏™-‡∏ï‡∏¥‡∏Å ‡πÑ‡∏ß-‡πÇ‡∏≠-‡πÄ‡∏•‡∏ô‡∏ã‡πå", th: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß" },
        { en: "Terrorism", read: "‡πÄ‡∏ó‡∏≠-‡πÄ‡∏£‡∏≠-‡∏£‡∏¥-‡∏ã‡∏∂‡πà‡∏°", th: "‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏¢" },
        { en: "Riot", read: "‡πÑ‡∏£-‡∏≠‡∏≠‡∏ó", th: "‡∏Å‡∏≤‡∏£‡∏à‡∏•‡∏≤‡∏à‡∏•" },

        // ‡∏´‡∏°‡∏ß‡∏î‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
        { en: "Patrol", read: "‡∏û‡∏∞-‡πÇ‡∏ó‡∏£‡∏•", th: "‡∏•‡∏≤‡∏î‡∏ï‡∏£‡∏∞‡πÄ‡∏ß‡∏ô" },
        { en: "Checkpoint", read: "‡πÄ‡∏ä‡πá‡∏Ñ-‡∏û‡∏≠‡∏¢‡∏ó‡πå", th: "‡∏î‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à" },
        { en: "Raid", read: "‡πÄ‡∏£‡∏î", th: "‡∏Å‡∏≤‡∏£‡∏à‡∏π‡πà‡πÇ‡∏à‡∏°/‡∏ö‡∏∏‡∏Å‡∏Ñ‡πâ‡∏ô" },
        { en: "Search", read: "‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ä", th: "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤" },
        { en: "Seize", read: "‡∏ã‡∏µ‡∏ã", th: "‡∏¢‡∏∂‡∏î/‡∏≠‡∏≤‡∏¢‡∏±‡∏î" },
        { en: "Surveillance", read: "‡πÄ‡∏ã‡∏≠‡∏£‡πå-‡πÄ‡∏ß-‡πÅ‡∏•‡∏ô‡∏ã‡πå", th: "‡∏Å‡∏≤‡∏£‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á/‡∏™‡∏≠‡∏î‡πÅ‡∏ô‡∏°" },
        { en: "Ambush", read: "‡πÅ‡∏≠‡∏°-‡∏ö‡∏∏‡∏ä", th: "‡∏ã‡∏∏‡πà‡∏°‡πÇ‡∏à‡∏°‡∏ï‡∏µ" },
        { en: "Squad", read: "‡∏™‡∏Ñ‡∏ß‡∏≠‡∏î", th: "‡∏´‡∏°‡∏π‡πà/‡∏´‡∏ô‡πà‡∏ß‡∏¢" },
        { en: "Reinforcement", read: "‡∏£‡∏µ-‡∏≠‡∏¥‡∏ô-‡∏ü‡∏≠‡∏£‡πå‡∏ã-‡πÄ‡∏°‡πâ‡∏ô‡∏ó‡πå", th: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°" },
        { en: "Fingerprint", read: "‡∏ü‡∏¥‡∏á-‡πÄ‡∏Å‡∏≠‡∏£‡πå-‡∏û‡∏£‡∏¥‡∏ô‡∏ó‡πå", th: "‡∏•‡∏≤‡∏¢‡∏ô‡∏¥‡πâ‡∏ß‡∏°‡∏∑‡∏≠" },
        { en: "Weapon", read: "‡πÄ‡∏ß‡∏û-‡∏û‡πà‡∏≠‡∏ô", th: "‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò" },
        { en: "Pistol", read: "‡∏û‡∏¥‡∏™-‡∏ó‡∏≠‡∏•", th: "‡∏õ‡∏∑‡∏ô‡∏û‡∏Å" },
        { en: "Bullet", read: "‡∏ö‡∏∏‡∏•-‡πÄ‡∏•‡πá‡∏ó", th: "‡∏Å‡∏£‡∏∞‡∏™‡∏∏‡∏ô" },
        { en: "Baton", read: "‡πÅ‡∏ö-‡∏ó‡∏≠‡∏ô", th: "‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏á" },
        { en: "Shield", read: "‡∏ä‡∏µ‡∏•‡∏î‡πå", th: "‡πÇ‡∏•‡πà" },
        { en: "Bulletproof vest", read: "‡∏ö‡∏∏‡∏•-‡πÄ‡∏•‡πá‡∏ó-‡∏û‡∏£‡∏π‡∏ü ‡πÄ‡∏ß‡∏™‡∏ó‡πå", th: "‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏∞‡∏™‡∏∏‡∏ô" },
        { en: "Uniform", read: "‡∏¢‡∏π-‡∏ô‡∏¥-‡∏ü‡∏≠‡∏£‡πå‡∏°", th: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö" },
        { en: "Badge", read: "‡πÅ‡∏ö‡∏î‡∏à‡πå", th: "‡∏ï‡∏£‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà" },
        { en: "Siren", read: "‡πÑ‡∏ã-‡πÄ‡∏£‡∏ô", th: "‡πÑ‡∏ã‡πÄ‡∏£‡∏ô" },
        { en: "Whistle", read: "‡∏ß‡∏¥‡∏™-‡πÄ‡∏ã‡∏¥‡πà‡∏•", th: "‡∏ô‡∏Å‡∏´‡∏ß‡∏µ‡∏î" },
        { en: "Flashlight", read: "‡πÅ‡∏ü‡∏•‡∏ä-‡πÑ‡∏•‡∏ó‡πå", th: "‡πÑ‡∏ü‡∏â‡∏≤‡∏¢" },
        { en: "Radio", read: "‡πÄ‡∏£-‡∏î‡∏¥-‡πÇ‡∏≠", th: "‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£" },
        { en: "Vehicle", read: "‡∏ß‡∏µ-‡∏Æ‡∏¥-‡πÄ‡∏Ñ‡∏¥‡∏•", th: "‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞" },
        { en: "Scene", read: "‡∏ã‡∏µ‡∏ô", th: "‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏" },
        { en: "Autopsy", read: "‡∏≠‡∏≠-‡∏ó‡πá‡∏≠‡∏õ-‡∏ã‡∏µ‡πà", th: "‡∏ä‡∏±‡∏ô‡∏™‡∏π‡∏ï‡∏£‡∏®‡∏û" },
        { en: "Forensic", read: "‡∏ü‡∏≠-‡πÄ‡∏£‡∏ô-‡∏ã‡∏¥‡∏Å", th: "‡∏ô‡∏¥‡∏ï‡∏¥‡πÄ‡∏ß‡∏ä" },
        { en: "Coroner", read: "‡∏Ñ‡∏≠-‡πÇ‡∏£-‡πÄ‡∏ô‡∏≠‡∏£‡πå", th: "‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏ô‡∏™‡∏π‡∏ï‡∏£" },

        // ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö
        { en: "Emergency", read: "‡∏≠‡∏µ-‡πÄ‡∏°‡∏≠-‡πÄ‡∏à‡∏ô-‡∏ã‡∏µ‡πà", th: "‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô" },
        { en: "Urgent", read: "‡πÄ‡∏≠‡∏≠-‡πÄ‡∏à‡πâ‡∏ô‡∏ó‡πå", th: "‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô" },
        { en: "Accident", read: "‡πÅ‡∏≠‡∏Ñ-‡∏ã‡∏¥-‡πÄ‡∏î‡∏ô‡∏ó‡πå", th: "‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏" },
        { en: "Injure", read: "‡∏≠‡∏¥‡∏ô-‡πÄ‡∏à‡πâ‡∏≠", th: "‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö" },
        { en: "Traffic", read: "‡πÅ‡∏ó‡∏£‡∏ü-‡∏ü‡∏¥‡∏Ñ", th: "‡∏à‡∏£‡∏≤‡∏à‡∏£" },
        { en: "Ticket", read: "‡∏ó‡∏¥‡∏Ñ-‡πÄ‡∏Å‡πá‡∏ï", th: "‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á" },
        { en: "License", read: "‡πÑ‡∏•-‡πÄ‡∏ã‡πà‡∏ô‡∏™‡πå", th: "‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï" },
        { en: "Identity", read: "‡πÑ‡∏≠-‡πÄ‡∏î‡∏ô-‡∏ó‡∏¥-‡∏ï‡∏µ‡πâ", th: "‡∏≠‡∏±‡∏ï‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå/‡∏ï‡∏±‡∏ß‡∏ï‡∏ô" },
        { en: "Immigration", read: "‡∏≠‡∏¥‡∏°-‡∏°‡∏¥-‡πÄ‡∏Å‡∏£-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á" },
        { en: "Border", read: "‡∏ö‡∏≠‡∏£‡πå-‡πÄ‡∏î‡∏≠‡∏£‡πå", th: "‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô" },
        { en: "Passport", read: "‡∏û‡∏≤‡∏™-‡∏û‡∏≠‡∏£‡πå‡∏ï", th: "‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á" },
        { en: "Visa", read: "‡∏ß‡∏µ-‡∏ã‡πà‡∏≤", th: "‡∏ß‡∏µ‡∏ã‡πà‡∏≤" },
        { en: "Foreigner", read: "‡∏ü‡∏≠-‡πÄ‡∏£‡∏ô-‡πÄ‡∏ô‡∏≠‡∏£‡πå", th: "‡∏ä‡∏≤‡∏ß‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥" },
        { en: "Embassy", read: "‡πÄ‡∏≠‡πá‡∏°-‡∏ö‡∏±‡∏™-‡∏ã‡∏µ‡πà", th: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏π‡∏ï" },
        { en: "Civilian", read: "‡∏ã‡∏¥-‡∏ß‡∏¥‡∏•-‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏ô", th: "‡∏û‡∏•‡πÄ‡∏£‡∏∑‡∏≠‡∏ô" },
        { en: "Volunteer", read: "‡∏ß‡∏≠-‡∏•‡∏±‡∏ô-‡πÄ‡∏ó‡∏µ‡∏¢‡∏£‡πå", th: "‡∏≠‡∏≤‡∏™‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£" },
        { en: "Evacuate", read: "‡∏≠‡∏µ-‡πÅ‡∏ß‡∏Ñ-‡∏Ñ‡∏π-‡πÄ‡∏≠‡∏ó", th: "‡∏≠‡∏û‡∏¢‡∏û" },
        { en: "Rescue", read: "‡πÄ‡∏£‡∏™-‡∏Ñ‡∏¥‡∏ß", th: "‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏†‡∏±‡∏¢" },
        { en: "Ambulance", read: "‡πÅ‡∏≠‡∏°-‡∏ö‡∏π-‡πÅ‡∏•‡∏ô‡∏ã‡πå", th: "‡∏£‡∏ñ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•" },
        { en: "Secure", read: "‡∏ã‡∏µ-‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏ß", th: "‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢/‡πÅ‡∏ô‡πà‡∏ô‡∏´‡∏ô‡∏≤" },
        { en: "Protect", read: "‡πÇ‡∏õ‡∏£-‡πÄ‡∏ó‡∏Ñ‡∏ó‡πå", th: "‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á" },
        { en: "Serve", read: "‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü", th: "‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£" },
        { en: "Duty", read: "‡∏î‡∏¥‡∏ß-‡∏ï‡∏µ‡πâ", th: "‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà" },
        { en: "Rank", read: "‡πÅ‡∏£‡∏á‡∏Ñ‡πå", th: "‡∏¢‡∏®" },
        { en: "Salute", read: "‡∏™‡∏∞-‡∏•‡∏π‡∏ó", th: "‡∏ß‡∏±‡∏ô‡∏ó‡∏¢‡∏≤‡∏´‡∏±‡∏ï‡∏ñ‡πå" },
        { en: "Report", read: "‡∏£‡∏µ-‡∏û‡∏≠‡∏£‡πå‡∏ï", th: "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô" },
        { en: "Order", read: "‡∏≠‡∏≠-‡πÄ‡∏î‡∏≠‡∏£‡πå", th: "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á" },
        { en: "Force", read: "‡∏ü‡∏≠‡∏£‡πå‡∏ã", th: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•/‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö" },
        { en: "Authority", read: "‡∏≠‡∏≠-‡∏ò‡∏≠-‡∏£‡∏¥-‡∏ï‡∏µ‡πâ", th: "‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà" },
        { en: "Protest", read: "‡πÇ‡∏õ‡∏£-‡πÄ‡∏ó‡∏™‡∏ó‡πå", th: "‡∏õ‡∏£‡∏∞‡∏ó‡πâ‡∏ß‡∏á" },
        { en: "Crowd", read: "‡∏Ñ‡∏£‡∏≤‡∏ß‡∏î‡πå", th: "‡∏ù‡∏π‡∏á‡∏ä‡∏ô" },
        { en: "Curfew", read: "‡πÄ‡∏Ñ‡∏≠‡∏£‡πå-‡∏ü‡∏¥‡∏ß", th: "‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡∏ü‡∏¥‡∏ß" },
        { en: "Violation", read: "‡πÑ‡∏ß-‡πÇ‡∏≠-‡πÄ‡∏•-‡∏ä‡∏±‡πà‡∏ô", th: "‡∏Å‡∏≤‡∏£‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô" },
        { en: "Illegal", read: "‡∏≠‡∏¥‡∏•-‡∏•‡∏µ-‡∏Å‡∏±‡∏•", th: "‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢" },
        { en: "Prohibit", read: "‡πÇ‡∏õ‡∏£-‡∏Æ‡∏¥-‡∏ö‡∏¥‡∏ó", th: "‡∏´‡πâ‡∏≤‡∏°" },
        { en: "Allow", read: "‡∏≠‡∏∞-‡∏•‡∏≤‡∏ß", th: "‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï" },
        { en: "Warning", read: "‡∏ß‡∏≠‡∏£‡πå-‡∏ô‡∏¥‡πà‡∏á", th: "‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" },
        { en: "Dangerous", read: "‡πÄ‡∏î‡∏ô-‡πÄ‡∏à-‡∏≠‡∏£‡∏±‡∏™", th: "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢" },
        { en: "Cautious", read: "‡∏Ñ‡∏≠-‡πÄ‡∏ä‡∏µ‡∏¢‡∏™", th: "‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á" },
        { en: "Suspicious", read: "‡∏ã‡∏±‡∏™-‡∏û‡∏¥-‡πÄ‡∏ä‡∏µ‡∏¢‡∏™", th: "‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢" },
        { en: "Identify", read: "‡πÑ‡∏≠-‡πÄ‡∏î‡∏ô-‡∏ó‡∏¥-‡∏ü‡∏≤‡∏¢", th: "‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô" },
        { en: "Essential", read: "‡πÄ‡∏≠‡∏™-‡πÄ‡∏ã‡∏ô-‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏•", th: "‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô" },
        { en: "Deficiency", read: "‡∏î‡∏¥-‡∏ü‡∏¥-‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ô-‡∏ã‡∏µ‡πà", th: "‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô" },
        { en: "Amass", read: "‡∏≠‡∏∞-‡πÅ‡∏°‡∏™", th: "‡∏™‡∏∞‡∏™‡∏°" },
        { en: "Abundant", read: "‡∏≠‡∏∞-‡∏ö‡∏±‡∏ô-‡πÅ‡∏î‡∏ô‡∏ó‡πå", th: "‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢" }
    ];

    // --- State & Storage ---
    let currentQuizList = [];
    let currentIdx = 0;
    let score = 0;
    let userAnswers = [];
    let userStats = JSON.parse(localStorage.getItem('policeExamStats')) || { grammar:0, vocab:0, convo:0, tricks:0, totalWrong:0 };

    function saveStats() { localStorage.setItem('policeExamStats', JSON.stringify(userStats)); }
    function clearData() { 
        if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
            localStorage.removeItem('policeExamStats');
            userStats = { grammar:0, vocab:0, convo:0, tricks:0, totalWrong:0 };
            alert("‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß");
            showScreen('mainMenu');
        }
    }

    // --- Navigation & UI ---
    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }
    function showLesson(id) {
        document.querySelectorAll('.lesson-detail').forEach(l => l.style.display='none');
        document.getElementById(id).style.display='block';
        showScreen('lessonContent');
    }

    function renderVocabTable() {
        const tbody = document.getElementById('vocabTableBody');
        let html = '';
        vocabData.forEach(v => {
            html += `<tr><td><span class="vocab-word">${v.en}</span><span class="vocab-read">${v.read}</span></td><td class="vocab-mean">${v.th}</td></tr>`;
        });
        tbody.innerHTML = html;
    }
    function filterVocab() {
        const input = document.getElementById('vocabSearch');
        const filter = input.value.toLowerCase();
        const rows = document.getElementById('vocabTableBody').getElementsByTagName('tr');
        for (let i = 0; i < rows.length; i++) {
            const txt = rows[i].textContent.toLowerCase();
            rows[i].style.display = txt.includes(filter) ? "" : "none";
        }
    }
    renderVocabTable();

    // --- Quiz Generators ---
    function generateVocabQuestions(amount, useReadingMode) {
        const result = [];
        const pool = [...vocabData].sort(() => 0.5 - Math.random());
        for (let i = 0; i < Math.min(amount, pool.length); i++) {
            const correctObj = pool[i];
            const distractorItems = vocabData.filter(item => item.en !== correctObj.en).sort(() => 0.5 - Math.random()).slice(0, 3);
            const options = [correctObj.th, ...distractorItems.map(d => d.th)].sort(() => 0.5 - Math.random());
            let qHtml = `<span style="font-size:32px; color:#2c3e50;">${correctObj.en}</span>`;
            if(useReadingMode) qHtml += `<br><span style="font-size:18px; color:#e67e22;">(${correctObj.read})</span>`;
            result.push({
                q: qHtml,
                options: options,
                answer: options.indexOf(correctObj.th),
                note: `<b>${correctObj.en}</b> (${correctObj.read}) = ${correctObj.th}`,
                cat: "vocab"
            });
        }
        return result;
    }

    function startRandomQuiz() {
        // Mixed: 20 Questions (15 general + 5 vocab)
        const mixed = questionBank.sort(() => 0.5 - Math.random()).slice(0, 15);
        const vocabs = generateVocabQuestions(5, false);
        currentQuizList = [...mixed, ...vocabs].sort(() => 0.5 - Math.random());
        initQuizState();
        document.getElementById('subQuestionText').style.display = 'none';
    }

    function startVocabGame() {
        // Vocab Only: 20 Questions
        currentQuizList = generateVocabQuestions(20, true);
        initQuizState();
        document.getElementById('subQuestionText').style.display = 'block';
    }

    function initQuizState() {
        currentIdx = 0;
        score = 0;
        userAnswers = new Array(currentQuizList.length).fill(null);
        showScreen('quizScreen');
        loadQuestion();
    }

    // --- Core Quiz Logic (With State Tracking) ---
    function loadQuestion() {
        const q = currentQuizList[currentIdx];
        
        // UI Updates
        document.getElementById('qCounter').innerText = `${currentIdx + 1}/${currentQuizList.length}`;
        document.getElementById('qCategoryTag').innerText = `‡∏´‡∏°‡∏ß‡∏î: ${q.cat.toUpperCase()}`;
        document.getElementById('questionText').innerHTML = q.q;
        document.getElementById('progressFill').style.width = (((currentIdx + 1) / currentQuizList.length) * 100) + "%";
        
        // Buttons State
        document.getElementById('prevBtn').style.display = currentIdx > 0 ? 'block' : 'none';
        
        const list = document.getElementById('optionsList');
        list.innerHTML = '';
        
        const answeredIndex = userAnswers[currentIdx];
        const isAnswered = answeredIndex !== null;

        q.options.forEach((opt, index) => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.innerHTML = opt;
            
            if (isAnswered) {
                if (index === q.answer) btn.classList.add('correct');
                if (index === answeredIndex && index !== q.answer) btn.classList.add('wrong');
                btn.classList.add('disabled');
            } else {
                btn.onclick = () => checkAnswer(index, btn);
            }
            list.appendChild(btn);
        });

        const feedback = document.getElementById('feedback');
        const nextBtn = document.getElementById('nextBtn');
        
        if (isAnswered) {
            const isCorrect = answeredIndex === q.answer;
            feedback.innerHTML = isCorrect 
                ? `<span style='color:#155724; font-weight:bold;'>‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</span><br>${q.note}`
                : `<span style='color:#721c24; font-weight:bold;'>‚ùå ‡∏ú‡∏¥‡∏î! ‡πÄ‡∏â‡∏•‡∏¢: ${q.options[q.answer]}</span><br>${q.note}`;
            feedback.className = 'feedback show';
            nextBtn.style.display = 'block';
        } else {
            feedback.className = 'feedback';
            nextBtn.style.display = 'none';
        }
    }

    function checkAnswer(selectedIndex, btnElement) {
        playClick();
        userAnswers[currentIdx] = selectedIndex;
        
        const q = currentQuizList[currentIdx];
        const feedback = document.getElementById('feedback');
        const allBtns = document.querySelectorAll('.option-btn');

        allBtns.forEach(b => b.classList.add('disabled'));

        if (selectedIndex === q.answer) {
            score++;
            btnElement.classList.add('correct');
            feedback.innerHTML = `<span style='color:#155724; font-weight:bold;'>‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</span><br>${q.note}`;
        } else {
            userStats[q.cat]++;
            userStats.totalWrong++;
            saveStats();
            btnElement.classList.add('wrong');
            allBtns[q.answer].classList.add('correct');
            feedback.innerHTML = `<span style='color:#721c24; font-weight:bold;'>‚ùå ‡∏ú‡∏¥‡∏î!</span><br>${q.note}`;
        }
        feedback.classList.add('show');
        document.getElementById('nextBtn').style.display = 'block';
    }

    function prevQuestion() {
        if(currentIdx > 0) {
            currentIdx--;
            loadQuestion();
        }
    }

    function nextQuestion() {
        currentIdx++;
        if (currentIdx < currentQuizList.length) {
            loadQuestion();
        } else {
            finishQuiz();
        }
    }

    function finishQuiz() {
        showScreen('resultScreen');
        document.getElementById('finalScore').innerText = `${score}/${currentQuizList.length}`;
        const pct = (score / currentQuizList.length) * 100;
        document.getElementById('resultTitle').innerText = pct >= 80 ? "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≠‡∏ö" : pct >= 50 ? "‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå" : "‡∏™‡∏π‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏õ!";
    }

    function analyzeWeakness() {
        showScreen('analysisScreen');
        const container = document.getElementById('statContainer');
        const recArea = document.getElementById('recommendationArea');
        const labels = { 'grammar':'Grammar', 'vocab':'‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå', 'convo':'‡∏™‡∏ô‡∏ó‡∏ô‡∏≤', 'tricks':'‡∏™‡∏π‡∏ï‡∏£‡∏à‡∏≥' };
        
        if (userStats.totalWrong === 0) {
            container.innerHTML = "<p style='text-align:center; color:#999;'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</p>";
            recArea.style.display = 'none';
            return;
        }
        
        let maxWrong = -1;
        let weakKey = "";
        let html = "";
        
        Object.keys(labels).forEach(key => {
            const count = userStats[key];
            if(count > 0) html += `<div class="stat-row"><span>${labels[key]}</span><span class="stat-bad">‡∏ú‡∏¥‡∏î ${count} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span></div>`;
            if(count > maxWrong) { maxWrong = count; weakKey = key; }
        });
        container.innerHTML = html;

        if (maxWrong > 0) {
            recArea.style.display = 'block';
            document.getElementById('weakPointName').innerText = labels[weakKey];
            document.getElementById('goToLessonBtn').onclick = () => { playClick(); showLesson('lesson-' + weakKey); };
        }
    }

    showScreen('mainMenu');
</script>

</body>
</html>
